<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Document</title>
</head>
<style type="text/css">
    .map {
        height: 1000px;
        width: 100%;
    }
</style>
<script src="https://cdn.jsdelivr.net/npm/ol@v7.1.0/dist/ol.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v7.1.0/ol.css">
<body>
<div id="map" class="map"></div>
</body>
<script>
    var map = new ol.Map({
        target: 'map'
    })

    // 地图设置中心
    var center = [113.928, 34.339];
    // 视图
    var view = new ol.View({
        projection: "EPSG:4326",
        center: center,
        zoom: 4
    })

    map.setView(view)
    // 计算图片映射到地图上的范围，保持比例的情况下。 放大100倍 除以2 让图片中心点和地图中心点重合
    var extent = [center[0] - (10169 * mScale) / 2, center[1] - (5172 * mScale) / 2, center[0] + (10169 * mScale) / 2, center[1] + (5172 * mScale) / 2]
    // 加载图片图层
    map.addLayer(
        new ol.layer.Image({
            source: new ol.source.ImageStatic({
                url: '../../img/22.jpg'
            })
        })
    )
    const vectorSource = new ol.source.Vector({wrapX: false});
    const vectorLayer = new ol.layer.Vector({
        source: vectorSource,
        style: {
            'fill-color': '#ffcc33',
            'stroke-color': '#ffcc33',
            'stroke-width': 20,
            'circle-radius': 20,
            'circle-fill-color': '#ffcc33',
        }
    });
    map.addLayer(vectorLayer);
    var center2 = ol.proj.transform([113.918, 34.338], 'EPSG:4326', 'EPSG:3857');
    console.log("center2:" + center2);
    let feature = new ol.Feature({
        geometry: new ol.geom.Point(center2)
    });
    vectorSource.addFeature(feature);

    let draw = new ol.interaction.Draw({
        source: vectorSource,
        type: 'Point',
        active: false
    });
    map.addInteraction(draw);
    draw.setActive(true);

    draw.on("drawend", function (event) {
        let equipFea = event.feature;
        console.log(equipFea.getGeometry().flatCoordinates)
    });
</script>
</html>